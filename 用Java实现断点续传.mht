From: <ÓÉ Microsoft Internet Explorer 5 ±£´æ>
Subject: =?gb2312?B?08NKYXZhyrXP1rbPtePQ+LSr?=
Date: Sat, 15 Sep 2001 23:35:42 +0800
MIME-Version: 1.0
Content-Type: multipart/related;
	boundary="----=_NextPart_000_0000_01C13E3F.22947160";
	type="text/html"
X-MimeOLE: Produced By Microsoft MimeOLE V5.00.2615.200

This is a multi-part message in MIME format.

------=_NextPart_000_0000_01C13E3F.22947160
Content-Type: text/html;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable
Content-Location: http://morninglihm.home.sohu.com/ftp_continue.htm

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>=D3=C3Java=CA=B5=CF=D6=B6=CF=B5=E3=D0=F8=B4=AB</TITLE>=

<META content=3D"text/html; charset=3Dgb2312" http-equiv=3DContent-Type>
<META content=3D"MSHTML 5.00.2614.3500" name=3DGENERATOR>
<META content=3DFrontPage.Editor.Document name=3DProgId></HEAD>
<BODY>
<TABLE border=3D0 cellPadding=3D0 cellSpacing=3D0 width=3D"100%">
  <TBODY>
  <TR vAlign=3Dtop>
    <TD><SPAN =
class=3Datitle>=D3=C3Java=CA=B5=CF=D6=B6=CF=B5=E3=D0=F8=B4=AB(HTTP)</SPAN=
></TD>
    <TD width=3D8><IMG alt=3D"" border=3D0 height=3D1=20
      src=3D"http://morninglihm.home.sohu.com/ftp_contibue_c.gif" =
width=3D8></TD>
    <TD>&nbsp;</TD>
    <TD width=3D6><IMG alt=3D"" border=3D0 height=3D1=20
      src=3D"http://morninglihm.home.sohu.com/ftp_contibue_c.gif" =
width=3D6></TD></TR><!-- Black line separator -->
  <TR vAlign=3Dtop>
    <TD bgColor=3D#000000 colSpan=3D5><IMG alt=3D"" border=3D0 =
height=3D1=20
      src=3D"http://morninglihm.home.sohu.com/ftp_contibue_c.gif" =
width=3D100></TD></TR>
  <TR vAlign=3Dtop>
    <TD bgColor=3D#ffffff colSpan=3D5><IMG alt=3D"" border=3D0 =
height=3D8=20
      src=3D"http://morninglihm.home.sohu.com/ftp_contibue_c.gif"=20
  width=3D100></TD></TR></TBODY></TABLE><!-- END HEADER AREA --><!-- =
START BODY AREA -->
<TABLE border=3D0 cellPadding=3D0 cellSpacing=3D0 width=3D"100%">
  <TBODY>
  <TR vAlign=3Dtop>
    <TD width=3D10><IMG alt=3D"" border=3D0 height=3D1=20
      src=3D"http://morninglihm.home.sohu.com/ftp_contibue_c.gif" =
width=3D10></TD>
    <TD width=3D"100%">
      <TABLE align=3Dright border=3D0 cellPadding=3D0 cellSpacing=3D0 =
width=3D168>
        <TBODY>
        <TR><!-- Sidebar Gutter -->
          <TD width=3D8><IMG alt=3D"" height=3D21=20
            src=3D"http://morninglihm.home.sohu.com/ftp_contibue_c.gif"=20
width=3D5></TD>
          <TD width=3D160><!-- Start TOC -->
            <TABLE border=3D0 cellPadding=3D0 cellSpacing=3D0 =
width=3D160>
              <TBODY>
              <TR>
                <TD bgColor=3D#000000 height=3D1 width=3D160><IMG =
alt=3D"" height=3D1=20
                  =
src=3D"http://morninglihm.home.sohu.com/ftp_contibue_c.gif"=20
                  width=3D160></TD></TR>
              <TR>
                <TD align=3Dmiddle=20
                =
background=3Dhttp://morninglihm.home.sohu.com/ftp_contibue_bg-gold.gif=20
                height=3D5><B>=C4=DA=C8=DD=A3=BA</B></TD></TR>
              <TR>
                <TD bgColor=3D#666666 height=3D1 width=3D160><IMG =
alt=3D"" height=3D1=20
                  =
src=3D"http://morninglihm.home.sohu.com/ftp_contibue_c.gif"=20
                  width=3D160></TD></TR>
              <TR>
                <TD align=3Dright>
                  <TABLE border=3D0 cellPadding=3D3 cellSpacing=3D0 =
width=3D"98%">
                    <TBODY>
                    <TR>
                      <TD><A=20
                        =
href=3D"http://morninglihm.home.sohu.com/ftp_continue.htm#1">(=D2=BB)=B6=CF=
=B5=E3=D0=F8=B4=AB=B5=C4=D4=AD=C0=ED</A></TD></TR>
                    <TR>
                      <TD><A=20
                        =
href=3D"http://morninglihm.home.sohu.com/ftp_continue.htm#2">(=B6=FE)Java=
=CA=B5=CF=D6=B6=CF=B5=E3=D0=F8=B4=AB=B5=C4=B9=D8=BC=FC=BC=B8=B5=E3</A></T=
D></TR>
                    <TR>
                      <TD><A=20
                        =
href=3D"http://morninglihm.home.sohu.com/ftp_continue.htm#3">(=C8=FD)=B6=CF=
=B5=E3=D0=F8=B4=AB=C4=DA=BA=CB=B5=C4=CA=B5=CF=D6</A></TD></TR>
                    <TR>
                      <TD><A=20
                        =
href=3D"http://morninglihm.home.sohu.com/ftp_continue.htm#author1">=B9=D8=
=D3=DA=D7=F7=D5=DF</A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE=
>
            <TABLE border=3D0 cellPadding=3D0 cellSpacing=3D0 =
width=3D160>
              <TBODY>
              <TR>
                <TD bgColor=3D#000000 colSpan=3D2 height=3D2 =
width=3D150><IMG alt=3D""=20
                  height=3D2=20
                  =
src=3D"http://morninglihm.home.sohu.com/ftp_contibue_c.gif"=20
                  width=3D160></TD></TR>
              <TR>
                <TD bgColor=3D#ffffff colSpan=3D2 height=3D2 =
width=3D150><IMG alt=3D""=20
                  height=3D2=20
                  =
src=3D"http://morninglihm.home.sohu.com/ftp_contibue_c.gif"=20
                  =
width=3D160></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <P><A=20
      =
href=3D"http://morninglihm.home.sohu.com/ftp_continue.htm#author1">=D6=D3=
=BB=AA</A>=20
      <BR><!-- <a href=3D"#author2">Author name</a> (<a =
href=3D"mailto:userid@us.ibm.com">email address</a>)<br />-->2001=20
      =C4=EA 5 =D4=C2</P>
      <P><A name=3D1><SPAN=20
      =
class=3Datitle2>(=D2=BB)=B6=CF=B5=E3=D0=F8=B4=AB=B5=C4=D4=AD=C0=ED</SPAN>=
</A><BR>=C6=E4=CA=B5=B6=CF=B5=E3=D0=F8=B4=AB=B5=C4=D4=AD=C0=ED=BA=DC=BC=F2=
=B5=A5=A3=AC=BE=CD=CA=C7=D4=DAHttp=B5=C4=C7=EB=C7=F3=C9=CF=BA=CD=D2=BB=B0=
=E3=B5=C4=CF=C2=D4=D8=D3=D0=CB=F9=B2=BB=CD=AC=B6=F8=D2=D1=A1=A3<BR>=B4=F2=
=B8=F6=B1=C8=B7=BD=A3=AC=E4=AF=C0=C0=C6=F7=C7=EB=C7=F3=B7=FE=CE=F1=C6=F7=C9=
=CF=B5=C4=D2=BB=B8=F6=CE=C4=CA=B1=A3=AC=CB=F9=B7=A2=B3=F6=B5=C4=C7=EB=C7=F3=
=C8=E7=CF=C2=A3=BA<BR>=BC=D9=C9=E8=B7=FE=CE=F1=C6=F7=D3=F2=C3=FB=CE=AAwww=
w.sjtu.edu.cn=A3=AC=CE=C4=BC=FE=C3=FB=CE=AAdown.zip=A1=A3<BR>GET=20
      /down.zip HTTP/1.1<BR>Accept: image/gif, image/x-xbitmap, =
image/jpeg,=20
      image/pjpeg, application/vnd.ms-<BR>excel, application/msword,=20
      application/vnd.ms-powerpoint, */*<BR>Accept-Language:=20
      zh-cn<BR>Accept-Encoding: gzip, deflate<BR>User-Agent: Mozilla/4.0 =

      (compatible; MSIE 5.01; Windows NT 5.0)<BR>Connection: =
Keep-Alive<BR></P>
      =
<P>=B7=FE=CE=F1=C6=F7=CA=D5=B5=BD=C7=EB=C7=F3=BA=F3=A3=AC=B0=B4=D2=AA=C7=F3=
=D1=B0=D5=D2=C7=EB=C7=F3=B5=C4=CE=C4=BC=FE=A3=AC=CC=E1=C8=A1=CE=C4=BC=FE=B5=
=C4=D0=C5=CF=A2=A3=AC=C8=BB=BA=F3=B7=B5=BB=D8=B8=F8=E4=AF=C0=C0=C6=F7=A3=AC=
=B7=B5=BB=D8=D0=C5=CF=A2=C8=E7=CF=C2=A3=BA<BR>
      =
<BLOCKQUOTE>200<BR>Content-Length=3D106786028<BR>Accept-Ranges=3Dbytes<BR=
>Date=3DMon,=20
        30 Apr 2001 12:56:11=20
        =
GMT<BR>ETag=3DW/"02ca57e173c11:95b"<BR>Content-Type=3Dapplication/octet-s=
tream<BR>Server=3DMicrosoft-IIS/5.0<BR>Last-Modified=3DMon,=20
        30 Apr 2001 12:56:11 GMT<BR></BLOCKQUOTE>
      <P>=A1=A1</P>
      =
<P>=CB=F9=CE=BD=B6=CF=B5=E3=D0=F8=B4=AB=A3=AC=D2=B2=BE=CD=CA=C7=D2=AA=B4=D3=
=CE=C4=BC=FE=D2=D1=BE=AD=CF=C2=D4=D8=B5=C4=B5=D8=B7=BD=BF=AA=CA=BC=BC=CC=D0=
=F8=CF=C2=D4=D8=A1=A3=CB=F9=D2=D4=D4=DA=BF=CD=BB=A7=B6=CB=E4=AF=C0=C0=C6=F7=
=B4=AB=B8=F8<BR>Web=B7=FE=CE=F1=C6=F7=B5=C4=CA=B1=BA=F2=D2=AA=B6=E0=BC=D3=
=D2=BB=CC=F5=D0=C5=CF=A2--=B4=D3=C4=C4=C0=EF=BF=AA=CA=BC=A1=A3<BR>=CF=C2=C3=
=E6=CA=C7=D3=C3=D7=D4=BC=BA=B1=E0=B5=C4=D2=BB=B8=F6"=E4=AF=C0=C0=C6=F7"=C0=
=B4=B4=AB=B5=DD=C7=EB=C7=F3=D0=C5=CF=A2=B8=F8Web=B7=FE=CE=F1=C6=F7=A3=AC=D2=
=AA=C7=F3=B4=D32000070=D7=D6=BD=DA=BF=AA=CA=BC=A1=A3<BR>GET=20
      /down.zip HTTP/1.0<BR>User-Agent: NetFox<BR>RANGE:=20
      bytes=3D2000070-<BR>Accept: text/html, image/gif, image/jpeg, *; =
q=3D.2, */*;=20
      q=3D.2<BR></P>
      =
<P>=D7=D0=CF=B8=BF=B4=D2=BB=CF=C2=BE=CD=BB=E1=B7=A2=CF=D6=B6=E0=C1=CB=D2=BB=
=D0=D0RANGE:=20
      =
bytes=3D2000070-<BR>=D5=E2=D2=BB=D0=D0=B5=C4=D2=E2=CB=BC=BE=CD=CA=C7=B8=E6=
=CB=DF=B7=FE=CE=F1=C6=F7down.zip=D5=E2=B8=F6=CE=C4=BC=FE=B4=D32000070=D7=D6=
=BD=DA=BF=AA=CA=BC=B4=AB=A3=AC=C7=B0=C3=E6=B5=C4=D7=D6=BD=DA=B2=BB=D3=C3=B4=
=AB=C1=CB=A1=A3<BR>=B7=FE=CE=F1=C6=F7=CA=D5=B5=BD=D5=E2=B8=F6=C7=EB=C7=F3=
=D2=D4=BA=F3=A3=AC=B7=B5=BB=D8=B5=C4=D0=C5=CF=A2=C8=E7=CF=C2=A3=BA<BR>206=
<BR>Content-Length=3D106786028<BR>Content-Range=3Dbytes=20
      2000070-106786027/106786028<BR>Date=3DMon, 30 Apr 2001 12:55:20=20
      =
GMT<BR>ETag=3DW/"02ca57e173c11:95b"<BR>Content-Type=3Dapplication/octet-s=
tream<BR>Server=3DMicrosoft-IIS/5.0<BR>Last-Modified=3DMon,=20
      30 Apr 2001 12:55:20 GMT<BR></P>
      =
<P>=BA=CD=C7=B0=C3=E6=B7=FE=CE=F1=C6=F7=B7=B5=BB=D8=B5=C4=D0=C5=CF=A2=B1=C8=
=BD=CF=D2=BB=CF=C2=A3=AC=BE=CD=BB=E1=B7=A2=CF=D6=D4=F6=BC=D3=C1=CB=D2=BB=D0=
=D0=A3=BA<BR>Content-Range=3Dbytes=20
      =
2000070-106786027/106786028<BR>=B7=B5=BB=D8=B5=C4=B4=FA=C2=EB=D2=B2=B8=C4=
=CE=AA206=C1=CB=A3=AC=B6=F8=B2=BB=D4=D9=CA=C7200=C1=CB=A1=A3<BR></P>
      =
<P>=D6=AA=B5=C0=C1=CB=D2=D4=C9=CF=D4=AD=C0=ED=A3=AC=BE=CD=BF=C9=D2=D4=BD=F8=
=D0=D0=B6=CF=B5=E3=D0=F8=B4=AB=B5=C4=B1=E0=B3=CC=C1=CB=A1=A3<BR></P>
      <P><A name=3D2><SPAN =
class=3Datitle2>(=B6=FE)Java=CA=B5=CF=D6=B6=CF=B5=E3=D0=F8=B4=AB=B5=C4=B9=
=D8=BC=FC=BC=B8=B5=E3</SPAN></A><BR>
      <OL>
        =
<LI>(1)=D3=C3=CA=B2=C3=B4=B7=BD=B7=A8=CA=B5=CF=D6=CC=E1=BD=BBRANGE:=20
        =
bytes=3D2000070-=A1=A3<BR>=B5=B1=C8=BB=D3=C3=D7=EE=D4=AD=CA=BC=B5=C4Socke=
t=CA=C7=BF=CF=B6=A8=C4=DC=CD=EA=B3=C9=B5=C4=A3=AC=B2=BB=B9=FD=C4=C7=D1=F9=
=CC=AB=B7=D1=CA=C2=C1=CB=A3=AC=C6=E4=CA=B5Java=B5=C4net=B0=FC=D6=D0=CC=E1=
=B9=A9=C1=CB=D5=E2=D6=D6=B9=A6=C4=DC=A1=A3=B4=FA=C2=EB=C8=E7=CF=C2=A3=BA<=
BR><BR>URL=20
        url =3D new =
URL("http://www.sjtu.edu.cn/down.zip");<BR>HttpURLConnection=20
        httpConnection =3D (HttpURLConnection)url.openConnection();<BR>
        =
<P>=A1=A1</P>//=C9=E8=D6=C3User-Agent<BR>httpConnection.setRequestPropert=
y("User-Agent","NetFox");<BR>//=C9=E8=D6=C3=B6=CF=B5=E3=D0=F8=B4=AB=B5=C4=
=BF=AA=CA=BC=CE=BB=D6=C3<BR>httpConnection.setRequestProperty("RANGE","by=
tes=3D2000070");<BR>//=BB=F1=B5=C3=CA=E4=C8=EB=C1=F7<BR>InputStream=20
        input =3D httpConnection.getInputStream();<BR>
        <P>=A1=A1</P>
        =
<P>=B4=D3=CA=E4=C8=EB=C1=F7=D6=D0=C8=A1=B3=F6=B5=C4=D7=D6=BD=DA=C1=F7=BE=CD=
=CA=C7down.zip=CE=C4=BC=FE=B4=D32000070=BF=AA=CA=BC=B5=C4=D7=D6=BD=DA=C1=F7=
=A1=A3<BR>=B4=F3=BC=D2=BF=B4=A3=AC=C6=E4=CA=B5=B6=CF=B5=E3=D0=F8=B4=AB=D3=
=C3Java=CA=B5=CF=D6=C6=F0=C0=B4=BB=B9=CA=C7=BA=DC=BC=F2=B5=A5=B5=C4=B0=C9=
=A1=A3<BR>=BD=D3=CF=C2=C0=B4=D2=AA=D7=F6=B5=C4=CA=C2=BE=CD=CA=C7=D4=F5=C3=
=B4=B1=A3=B4=E6=BB=F1=B5=C3=B5=C4=C1=F7=B5=BD=CE=C4=BC=FE=D6=D0=C8=A5=C1=CB=
=A1=A3<BR></P>
        =
<LI>=B1=A3=B4=E6=CE=C4=BC=FE=B2=C9=D3=C3=B5=C4=B7=BD=B7=A8=A1=A3<BR>=CE=D2=
=B2=C9=D3=C3=B5=C4=CA=C7IO=B0=FC=D6=D0=B5=C4RandAccessFile=C0=E0=A1=A3<BR=
>=B2=D9=D7=F7=CF=E0=B5=B1=BC=F2=B5=A5=A3=AC=BC=D9=C9=E8=B4=D32000070=B4=A6=
=BF=AA=CA=BC=B1=A3=B4=E6=CE=C4=BC=FE=A3=AC=B4=FA=C2=EB=C8=E7=CF=C2=A3=BA<=
BR>RandomAccess=20
        oSavedFile =3D new RandomAccessFile("down.zip","rw");<BR>long =
nPos =3D=20
        =
2000070;<BR>//=B6=A8=CE=BB=CE=C4=BC=FE=D6=B8=D5=EB=B5=BDnPos=CE=BB=D6=C3<=
BR>oSavedFile.seek(nPos);<BR>byte[] b =3D new=20
        byte[1024];<BR>int=20
        =
nRead;<BR>//=B4=D3=CA=E4=C8=EB=C1=F7=D6=D0=B6=C1=C8=EB=D7=D6=BD=DA=C1=F7=A3=
=AC=C8=BB=BA=F3=D0=B4=B5=BD=CE=C4=BC=FE=D6=D0<BR>while((nRead=3Dinput.rea=
d(b,0,1024))=20
        &gt; 0)<BR>{<BR>oSavedFile.write(b,0,nRead);<BR>}<BR></LI></OL>
      =
<P>=D4=F5=C3=B4=D1=F9=A3=AC=D2=B2=BA=DC=BC=F2=B5=A5=B0=C9=A1=A3<BR>=BD=D3=
=CF=C2=C0=B4=D2=AA=D7=F6=B5=C4=BE=CD=CA=C7=D5=FB=BA=CF=B3=C9=D2=BB=B8=F6=CD=
=EA=D5=FB=B5=C4=B3=CC=D0=F2=C1=CB=A1=A3=B0=FC=C0=A8=D2=BB=CF=B5=C1=D0=B5=C4=
=CF=DF=B3=CC=BF=D8=D6=C6=B5=C8=B5=C8=A1=A3<BR></P>
      =
<P><BR><B>(=C8=FD)=B6=CF=B5=E3=D0=F8=B4=AB=C4=DA=BA=CB=B5=C4=CA=B5=CF=D6<=
/B><BR>=D6=F7=D2=AA=D3=C3=C1=CB6=B8=F6=C0=E0=A3=AC=B0=FC=C0=A8=D2=BB=B8=F6=
=B2=E2=CA=D4=C0=E0=A1=A3<BR>SiteFileFetch.java=B8=BA=D4=F0=D5=FB=B8=F6=CE=
=C4=BC=FE=B5=C4=D7=A5=C8=A1=A3=AC=BF=D8=D6=C6=C4=DA=B2=BF=CF=DF=B3=CC(Fil=
eSplitterFetch=C0=E0)=A1=A3<BR>FileSplitterFetch.java=B8=BA=D4=F0=B2=BF=B7=
=D6=CE=C4=BC=FE=B5=C4=D7=A5=C8=A1=A1=A3<BR>FileAccess.java=B8=BA=D4=F0=CE=
=C4=BC=FE=B5=C4=B4=E6=B4=A2=A1=A3<BR>SiteInfoBean.java=D2=AA=D7=A5=C8=A1=B5=
=C4=CE=C4=BC=FE=B5=C4=D0=C5=CF=A2=A3=AC=C8=E7=CE=C4=BC=FE=B1=A3=B4=E6=B5=C4=
=C4=BF=C2=BC=A3=AC=C3=FB=D7=D6=A3=AC=D7=A5=C8=A1=CE=C4=BC=FE=B5=C4URL=B5=C8=
=A1=A3<BR>Utility.java=B9=A4=BE=DF=C0=E0=A3=AC=B7=C5=D2=BB=D0=A9=BC=F2=B5=
=A5=B5=C4=B7=BD=B7=A8=A1=A3<BR>TestMethod.java=B2=E2=CA=D4=C0=E0=A1=A3<BR=
></P>
      <P>=CF=C2=C3=E6=CA=C7=D4=B4=B3=CC=D0=F2=A3=BA=20
      <TABLE bgColor=3D#cccccc border=3D1 cellPadding=3D5 =
cellSpacing=3D0=20
        width=3D"100%"><TBODY>
        <TR>
          <TD><PRE><CODE>
/*
**SiteFileFetch.java
*/
package NetFox;
import java.io.*;
import java.net.*;


public class SiteFileFetch extends Thread {


SiteInfoBean siteInfoBean =3D null; //=CE=C4=BC=FE=D0=C5=CF=A2Bean
long[] nStartPos; //=BF=AA=CA=BC=CE=BB=D6=C3
long[] nEndPos; //=BD=E1=CA=F8=CE=BB=D6=C3
FileSplitterFetch[] fileSplitterFetch; //=D7=D3=CF=DF=B3=CC=B6=D4=CF=F3
long nFileLength; //=CE=C4=BC=FE=B3=A4=B6=C8
boolean bFirst =3D true; =
//=CA=C7=B7=F1=B5=DA=D2=BB=B4=CE=C8=A1=CE=C4=BC=FE
boolean bStop =3D false; //=CD=A3=D6=B9=B1=EA=D6=BE
File tmpFile; //=CE=C4=BC=FE=CF=C2=D4=D8=B5=C4=C1=D9=CA=B1=D0=C5=CF=A2
DataOutputStream output; =
//=CA=E4=B3=F6=B5=BD=CE=C4=BC=FE=B5=C4=CA=E4=B3=F6=C1=F7


public SiteFileFetch(SiteInfoBean bean) throws IOException
{
siteInfoBean =3D bean;
//tmpFile =3D File.createTempFile ("zhong","1111",new =
File(bean.getSFilePath()));
tmpFile =3D new File(bean.getSFilePath()+File.separator + =
bean.getSFileName()+".info");
if(tmpFile.exists ())
{
bFirst =3D false;
read_nPos();
}
else
{
nStartPos =3D new long[bean.getNSplitter()];
nEndPos =3D new long[bean.getNSplitter()];
}



}


public void run()
{
//=BB=F1=B5=C3=CE=C4=BC=FE=B3=A4=B6=C8
//=B7=D6=B8=EE=CE=C4=BC=FE
//=CA=B5=C0=FDFileSplitterFetch
//=C6=F4=B6=AFFileSplitterFetch=CF=DF=B3=CC
//=B5=C8=B4=FD=D7=D3=CF=DF=B3=CC=B7=B5=BB=D8
try{
if(bFirst)
{
nFileLength =3D getFileSize();
if(nFileLength =3D=3D -1)
{
System.err.println("File Length is not known!");
}
else if(nFileLength =3D=3D -2)
{
System.err.println("File is not access!");
}
else
{
for(int i=3D0;i&lt;nStartPos.length;i++)
{
nStartPos[i] =3D (long)(i*(nFileLength/nStartPos.length));
}
for(int i=3D0;i&lt;nEndPos.length-1;i++)
{
nEndPos[i] =3D nStartPos[i+1];
}
nEndPos[nEndPos.length-1] =3D nFileLength;
}
}


//=C6=F4=B6=AF=D7=D3=CF=DF=B3=CC
fileSplitterFetch =3D new FileSplitterFetch[nStartPos.length];
for(int i=3D0;i&lt;nStartPos.length;i++)
{
fileSplitterFetch[i] =3D new =
FileSplitterFetch(siteInfoBean.getSSiteURL(),
siteInfoBean.getSFilePath() + File.separator + =
siteInfoBean.getSFileName(),
nStartPos[i],nEndPos[i],i);
Utility.log("Thread " + i + " , nStartPos =3D " + nStartPos[i] + ", =
nEndPos =3D " + nEndPos[i]);
fileSplitterFetch[i].start();
}
// fileSplitterFetch[nPos.length-1] =3D new =
FileSplitterFetch(siteInfoBean.getSSiteURL(),
siteInfoBean.getSFilePath() + File.separator + =
siteInfoBean.getSFileName(),nPos[nPos.length-1],nFileLength,nPos.length-1=
);
// Utility.log("Thread " + (nPos.length-1) + " , nStartPos =3D " + =
nPos[nPos.length-1] + ",
nEndPos =3D " + nFileLength);
// fileSplitterFetch[nPos.length-1].start();


//=B5=C8=B4=FD=D7=D3=CF=DF=B3=CC=BD=E1=CA=F8
//int count =3D 0;
//=CA=C7=B7=F1=BD=E1=CA=F8while=D1=AD=BB=B7
boolean breakWhile =3D false;


while(!bStop)
{
write_nPos();
Utility.sleep(500);
breakWhile =3D true;


for(int i=3D0;i&lt;nStartPos.length;i++)
{
if(!fileSplitterFetch[i].bDownOver)
{
breakWhile =3D false;
break;
}
}
if(breakWhile)
break;


//count++;
//if(count&gt;4)
// siteStop();
}


System.err.println("=CE=C4=BC=FE=CF=C2=D4=D8=BD=E1=CA=F8=A3=A1");
}
catch(Exception e){e.printStackTrace ();}
}


//=BB=F1=B5=C3=CE=C4=BC=FE=B3=A4=B6=C8
public long getFileSize()
{
int nFileLength =3D -1;
try{
URL url =3D new URL(siteInfoBean.getSSiteURL());
HttpURLConnection httpConnection =3D =
(HttpURLConnection)url.openConnection ();
httpConnection.setRequestProperty("User-Agent","NetFox");


int responseCode=3DhttpConnection.getResponseCode();
if(responseCode&gt;=3D400)
{
processErrorCode(responseCode);
return -2; //-2 represent access is error
}


String sHeader;


for(int i=3D1;;i++)
{
//DataInputStream in =3D new =
DataInputStream(httpConnection.getInputStream ());
//Utility.log(in.readLine());
sHeader=3DhttpConnection.getHeaderFieldKey(i);
if(sHeader!=3Dnull)
{
if(sHeader.equals("Content-Length"))
{
nFileLength =3D =
Integer.parseInt(httpConnection.getHeaderField(sHeader));
break;
}
}
else
break;
}
}
catch(IOException e){e.printStackTrace ();}
catch(Exception e){e.printStackTrace ();}


Utility.log(nFileLength);


return nFileLength;
}


//=B1=A3=B4=E6=CF=C2=D4=D8=D0=C5=CF=A2=A3=A8=CE=C4=BC=FE=D6=B8=D5=EB=CE=BB=
=D6=C3=A3=A9
private void write_nPos()
{
try{
output =3D new DataOutputStream(new FileOutputStream(tmpFile));
output.writeInt(nStartPos.length);
for(int i=3D0;i&lt;nStartPos.length;i++)
{
// output.writeLong(nPos[i]);
output.writeLong(fileSplitterFetch[i].nStartPos);
output.writeLong(fileSplitterFetch[i].nEndPos);
}
output.close();
}
catch(IOException e){e.printStackTrace ();}
catch(Exception e){e.printStackTrace ();}
}


//=B6=C1=C8=A1=B1=A3=B4=E6=B5=C4=CF=C2=D4=D8=D0=C5=CF=A2=A3=A8=CE=C4=BC=FE=
=D6=B8=D5=EB=CE=BB=D6=C3=A3=A9
private void read_nPos()
{
try{
DataInputStream input =3D new DataInputStream(new =
FileInputStream(tmpFile));
int nCount =3D input.readInt();
nStartPos =3D new long[nCount];
nEndPos =3D new long[nCount];
for(int i=3D0;i&lt;nStartPos.length;i++)
{
nStartPos[i] =3D input.readLong();
nEndPos[i] =3D input.readLong();
}
input.close();
}
catch(IOException e){e.printStackTrace ();}
catch(Exception e){e.printStackTrace ();}
}


private void processErrorCode(int nErrorCode)
{
System.err.println("Error Code : " + nErrorCode);
}


//=CD=A3=D6=B9=CE=C4=BC=FE=CF=C2=D4=D8
public void siteStop()
{
bStop =3D true;
for(int i=3D0;i&lt;nStartPos.length;i++)
fileSplitterFetch[i].splitterStop();


}
}
/*
**FileSplitterFetch.java
*/
package NetFox;


import java.io.*;
import java.net.*;


public class FileSplitterFetch extends Thread {


String sURL; //File URL
long nStartPos; //File Snippet Start Position
long nEndPos; //File Snippet End Position
int nThreadID; //Thread's ID
boolean bDownOver =3D false; //Downing is over
boolean bStop =3D false; //Stop identical
FileAccessI fileAccessI =3D null; //File Access interface


public FileSplitterFetch(String sURL,String sName,long nStart,long =
nEnd,int id) throws IOException
{
this.sURL =3D sURL;
this.nStartPos =3D nStart;
this.nEndPos =3D nEnd;
nThreadID =3D id;
fileAccessI =3D new FileAccessI(sName,nStartPos);
}


public void run()
{
while(nStartPos &lt; nEndPos &amp;&amp; !bStop)
{


try{
URL url =3D new URL(sURL);
HttpURLConnection httpConnection =3D =
(HttpURLConnection)url.openConnection ();
httpConnection.setRequestProperty("User-Agent","NetFox");
String sProperty =3D "bytes=3D"+nStartPos+"-";
httpConnection.setRequestProperty("RANGE",sProperty);
Utility.log(sProperty);


InputStream input =3D httpConnection.getInputStream();
//logResponseHead(httpConnection);


byte[] b =3D new byte[1024];
int nRead;
while((nRead=3Dinput.read(b,0,1024)) &gt; 0 &amp;&amp; nStartPos &lt; =
nEndPos &amp;&amp; !bStop)
{
nStartPos +=3D fileAccessI.write(b,0,nRead);
//if(nThreadID =3D=3D 1)
// Utility.log("nStartPos =3D " + nStartPos + ", nEndPos =3D " + =
nEndPos);
}


Utility.log("Thread " + nThreadID + " is over!");
bDownOver =3D true;
//nPos =3D fileAccessI.write (b,0,nRead);
}
catch(Exception e){e.printStackTrace ();}
}
}


//=B4=F2=D3=A1=BB=D8=D3=A6=B5=C4=CD=B7=D0=C5=CF=A2
public void logResponseHead(HttpURLConnection con)
{
for(int i=3D1;;i++)
{
String header=3Dcon.getHeaderFieldKey(i);
if(header!=3Dnull)
//responseHeaders.put(header,httpConnection.getHeaderField(header));
Utility.log(header+" : "+con.getHeaderField(header));
else
break;
}
}


public void splitterStop()
{
bStop =3D true;
}


}


/*
**FileAccess.java
*/
package NetFox;
import java.io.*;


public class FileAccessI implements Serializable{


RandomAccessFile oSavedFile;
long nPos;


public FileAccessI() throws IOException
{
this("",0);
}


public FileAccessI(String sName,long nPos) throws IOException
{
oSavedFile =3D new RandomAccessFile(sName,"rw");
this.nPos =3D nPos;
oSavedFile.seek(nPos);
}


public synchronized int write(byte[] b,int nStart,int nLen)
{
int n =3D -1;
try{
oSavedFile.write(b,nStart,nLen);
n =3D nLen;
}
catch(IOException e)
{
e.printStackTrace ();
}


return n;
}


}


/*
**SiteInfoBean.java
*/
package NetFox;


public class SiteInfoBean {


private String sSiteURL; //Site's URL
private String sFilePath; //Saved File's Path
private String sFileName; //Saved File's Name
private int nSplitter; //Count of Splited Downloading File


public SiteInfoBean()
{
//default value of nSplitter is 5
this("","","",5);
}


public SiteInfoBean(String sURL,String sPath,String sName,int nSpiltter)
{
sSiteURL=3D sURL;
sFilePath =3D sPath;
sFileName =3D sName;
this.nSplitter =3D nSpiltter;


}


public String getSSiteURL()
{
return sSiteURL;
}


public void setSSiteURL(String value)
{
sSiteURL =3D value;
}


public String getSFilePath()
{
return sFilePath;
}


public void setSFilePath(String value)
{
sFilePath =3D value;
}


public String getSFileName()
{
return sFileName;
}


public void setSFileName(String value)
{
sFileName =3D value;
}


public int getNSplitter()
{
return nSplitter;
}


public void setNSplitter(int nCount)
{
nSplitter =3D nCount;
}
}


/*
**Utility.java
*/
package NetFox;


public class Utility {


public Utility()
{


}


public static void sleep(int nSecond)
{
try{
Thread.sleep(nSecond);
}
catch(Exception e)
{
e.printStackTrace ();
}
}


public static void log(String sMsg)
{
System.err.println(sMsg);
}


public static void log(int sMsg)
{
System.err.println(sMsg);
}
}


/*
**TestMethod.java
*/
package NetFox;


public class TestMethod {


public TestMethod()
{ ///xx/weblogic60b2_win.exe
try{
SiteInfoBean bean =3D new =
SiteInfoBean("http://localhost/xx/weblogic60b2_win.exe","L:\\temp","weblo=
gic60b2_win.exe",5);
//SiteInfoBean bean =3D new =
SiteInfoBean("http://localhost:8080/down.zip","L:\\temp","weblogic60b2_wi=
n.exe",5);
SiteFileFetch fileFetch =3D new SiteFileFetch(bean);
fileFetch.start();
}
catch(Exception e){e.printStackTrace ();}


}


public static void main(String[] args)
{
new TestMethod();
}
}
</CODE></PRE></TD></TR></TBODY></TABLE></P></TD></TR></TBODY></TABLE></BO=
DY></HTML>

------=_NextPart_000_0000_01C13E3F.22947160
Content-Type: image/gif
Content-Transfer-Encoding: base64
Content-Location: http://morninglihm.home.sohu.com/ftp_contibue_c.gif

R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==

------=_NextPart_000_0000_01C13E3F.22947160
Content-Type: image/gif
Content-Transfer-Encoding: base64
Content-Location: http://morninglihm.home.sohu.com/ftp_contibue_bg-gold.gif

R0lGODlhAgACAIAAAP/MZv///ywAAAAAAgACAAACAwwQBQA7

------=_NextPart_000_0000_01C13E3F.22947160--
